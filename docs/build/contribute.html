

<!DOCTYPE html>
<head>
  <meta charset="utf-8">
  <meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Contribute to Inversion Test Problems &mdash; Inversion Test Problems 0.0.1 documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="_static/css/theme.min.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/custom.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/theme.min.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Installation" href="installation.html" /> 

</head>

<body>
    <header>
        <div class="container">
            <a class="site-nav-toggle hidden-lg-up"><i class="icon-menu"></i></a>
            <a class="site-title" href="index.html">
                Inversion Test Problems
            </a>
        </div>
    </header>


<div class="breadcrumbs-outer hidden-xs-down">
    <div class="container">
        















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="breadcrumbs">
    
      <li><a href="index.html">Docs</a></li>
        
      <li>Contribute to Inversion Test Problems</li>
    
    
      <li class="breadcrumbs-aside">
        
            
            <a href="_sources/contribute.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>
</div>
    </div>
</div>
    <div class="main-outer">
        <div class="container">
            <div class="row">
                <div class="col-12 col-lg-3 site-nav">
                    
<div role="search">
    <form class="search" action="search.html" method="get">
        <div class="icon-input">
            <input type="text" name="q" placeholder="Search" />
            <span class="icon-search"></span>
        </div>
        <input type="submit" value="Go" class="d-hidden" />
        <input type="hidden" name="check_keywords" value="yes" />
        <input type="hidden" name="area" value="default" />
    </form>
</div>
                    <div class="site-nav-tree">
                        
                            
                            
                                <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Contribute to Inversion Test Problems</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#reporting-issues">Reporting issues</a></li>
<li class="toctree-l2"><a class="reference internal" href="#how-to-contribute">How to contribute</a></li>
</ul>
</li>
</ul>

                            
                        
                    </div>
                </div>
                <div class="col-12 col-lg-9">
                    <div class="document">
                        
                            
  <section id="contribute-to-inversion-test-problems">
<h1>Contribute to Inversion Test Problems<a class="headerlink" href="#contribute-to-inversion-test-problems" title="Permalink to this headline">¶</a></h1>
<section id="reporting-issues">
<h2>Reporting issues<a class="headerlink" href="#reporting-issues" title="Permalink to this headline">¶</a></h2>
<p>Bug reports and feature requests are welcome. Please search before lodging an issue at
our Github <a class="reference external" href="https://github.com/inlab-geo/inversion-test-problems">repository</a>.</p>
</section>
<section id="how-to-contribute">
<h2>How to contribute<a class="headerlink" href="#how-to-contribute" title="Permalink to this headline">¶</a></h2>
<p>Thank you for contributing to Inversion Test Problems! Inversion test problems is
a community driven effort to create a collection of forward
codes, simulating a wide range of physical problems. ITP relies on you to
contribute your forward code! You do not need to know all the detailes to get started.
Here we explain step by step how to contribute your code to ITP. If this page
does not answer all of your questions, don’t hesitate to contact us via
<a class="reference external" href="https://github.com/inlab-geo/inversion-test-problemscofi/issues/new/choose">GitHub issues</a>
or <a class="reference external" href="https://inlab-geo.slack.com">Slack</a>.</p>
<section id="setting-it-up-right">
<h3>Setting it up right<a class="headerlink" href="#setting-it-up-right" title="Permalink to this headline">¶</a></h3>
<p>We assume that the potential contributor already has a Github account and
established a secure connection using https or SSH. If you wish to set up a new
account or connection before contributing, please see here:</p>
<p><a class="reference external" href="https://docs.github.com/en/get-started">Getting started with Github</a>,
and <a class="reference external" href="https://docs.github.com/en/authentication/keeping-your-account-and-data-secure/creating-a-personal-access-token">creating a personal access token</a>.</p>
<section id="fork-and-clone-the-itp-repository">
<h4>Fork and clone the ITP repository<a class="headerlink" href="#fork-and-clone-the-itp-repository" title="Permalink to this headline">¶</a></h4>
<ol class="arabic" id="fork-clone">
<li><p>Navigate to the <a class="reference external" href="https://github.com/inlab-geo/inversion-test-problems">GitHub repository</a></p></li>
<li><p>Click the “Fork” button on top right of the page (followed by a confirmation page
with a “Create fork” button)</p></li>
<li><p>Now you will be redirected to your own fork of <code class="docutils literal notranslate"><span class="pre">Inversion</span> <span class="pre">Test</span> <span class="pre">Problems</span></code>,
where you can freely commit changes and add your code.</p>
<div class="mermaid">
            %%{init: { 'logLevel': 'debug', 'theme': 'base', 'gitGraph': {'showCommitLabel': false}} }%%
  gitGraph
    commit
    commit
    branch your_own_fork
    checkout your_own_fork
    commit
    commit
    checkout main
    merge your_own_fork
    commit
    commit
        </div></li>
<li><p>Next, create a local copy of your ITP repository using ‘’clone’’
(Github slang for download):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">clone</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">YOUR_GITHUB_ACCOUNT</span><span class="o">/</span><span class="n">inversion</span><span class="o">-</span><span class="n">test</span><span class="o">-</span><span class="n">problems</span><span class="o">.</span><span class="n">git</span>
</pre></div>
</div>
<p>replacing <code class="docutils literal notranslate"><span class="pre">YOUR_GITHUB_ACCOUNT</span></code> with your own account.</p>
</li>
</ol>
</section>
<section id="environment-setup">
<h4>Environment setup<a class="headerlink" href="#environment-setup" title="Permalink to this headline">¶</a></h4>
<p id="env-setup">We recommend to use a clean environment to avoid dependency issues. Here we use
conda to create the environment (<a class="reference external" href="https://docs.conda.io/projects/conda/en/latest/user-guide/install/index.html#">How to install conda</a>).
Create a new environment using these commands:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">conda</span> <span class="n">create</span> <span class="o">-</span><span class="n">n</span> <span class="n">NEW_PROBLEM</span> <span class="n">scipy</span> <span class="n">matplotlib</span>
</pre></div>
</div>
<p>Replace NEW_PROBLEM with a sensible name. Next, activate the new environment:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">conda</span> <span class="n">activate</span> <span class="n">NEW_PROBLEM</span>
</pre></div>
</div>
</section>
</section>
<section id="create-your-own-inversion-test-problem">
<h3>Create your own Inversion Test Problem<a class="headerlink" href="#create-your-own-inversion-test-problem" title="Permalink to this headline">¶</a></h3>
<p>A new contribution to Inversion Test Problem has to conform to a consistent
file structure. The simplest way to ensure that a new contribution includes
all files is to start the creation of a new problem from the template.
Execute the following command in the ROOT folder of the cloned Github repository
of ITP (replacing NEW_PROBLEM with the previous choice):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="n">utils</span><span class="o">/</span><span class="n">_create_new_example</span><span class="o">.</span><span class="n">py</span> <span class="n">NEW_PROBLEM</span>
</pre></div>
</div>
<p>A new folder with the name NEW_PROBLEM is created under ROOT/contrib/ that contains
all files needed for a new contribution.</p>
<p>There is a whole lot of stuff that needs to be in order to make a successful
contribution. Details are listed here for now:</p>
<ol class="arabic">
<li><p>All files as generated by the template must be present in the contributed
folder.</p></li>
<li><p>Do not change files outside of your folder. In case you changed files in
the rest of the repository, do the following steps:</p>
<ul>
<li><p>Create a backup of your contribution (the folder contrib/NEW_PROBLEM)</p></li>
<li><p>Delete your local version of inversion-test-problems</p></li>
<li><p>Re-run this command to get a clean version of the repository:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">clone</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">YOUR_GITHUB_ACCOUNT</span><span class="o">/</span><span class="n">inversion</span><span class="o">-</span><span class="n">test</span><span class="o">-</span><span class="n">problems</span><span class="o">.</span><span class="n">git</span>
</pre></div>
</div>
</li>
<li><p>Copy/past your folder NEW_PROBLEM to inversion-test-problems/contrib/</p></li>
</ul>
</li>
<li><p>Choose a sensible, unique name for your contribution.</p></li>
<li><p>The name of the contribution (NEW_PROBLEM) must be used twice:</p>
<ul>
<li><p>for the folder name: inversion-test-problems/contrib/NEW_PROBLEM</p></li>
<li><p>for the central class object in NEW_PROBLEM/__init__.py, i.e.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">new_problem</span><span class="p">():</span>
</pre></div>
</div>
</li>
</ul>
</li>
<li><p>Some contributions might want to include measured values. A contribution can
include small datasets in plain textfiles (ASCII or similar). Data files have
to be stored in /contrib/NEW_PROBLEM/data/ and can be loaded using the
following code:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">tmp</span> <span class="o">=</span> <span class="n">pkgutil</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="vm">__name__</span><span class="p">,</span> <span class="s2">&quot;data/testdata.txt&quot;</span><span class="p">)</span>
<span class="n">tmp2</span><span class="o">=</span><span class="n">tmp</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span>
<span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">StringIO</span><span class="p">(</span><span class="n">tmp2</span><span class="p">))</span>
<span class="k">del</span>  <span class="n">tmp</span><span class="p">,</span> <span class="n">tmp2</span>
</pre></div>
</div>
</li>
</ol>
</section>
<section id="commit-push-and-pull-request">
<h3>Commit, push and pull request<a class="headerlink" href="#commit-push-and-pull-request" title="Permalink to this headline">¶</a></h3>
<p>Next, add the new test problem as a new folder to <code class="docutils literal notranslate"><span class="pre">scr/inversiontestproblems/newproblem</span></code> (replacing <code class="docutils literal notranslate"><span class="pre">newproblem</span></code> with the new problem name) and add the Jupyter Notebook with the name ‘’newproblem.ipynb’’ to the <code class="docutils literal notranslate"><span class="pre">Jupyter</span> <span class="pre">Notebooks</span></code> folder.</p>
<p>Then use the following commands to upload the new test problem to the repository:</p>
<p><code class="docutils literal notranslate"><span class="pre">`console</span>
<span class="pre">git</span> <span class="pre">add</span> <span class="pre">.</span>
<span class="pre">git</span> <span class="pre">commit</span> <span class="pre">-m</span> <span class="pre">&quot;A</span> <span class="pre">sentence</span> <span class="pre">that</span> <span class="pre">describes</span> <span class="pre">the</span> <span class="pre">new</span> <span class="pre">problem.&quot;</span>
<span class="pre">git</span> <span class="pre">push</span>
<span class="pre">`</span></code></p>
<p>The new test problem is now uploaded into the repository. As a last step, visit <a class="reference external" href="https://github.com/inlab-geo/inversion-test-problems/branches">https://github.com/inlab-geo/inversion-test-problems/branches</a>. Locate the new branch and click on “create pull request”. If the changes are confined to the new folder and Jupyter Notebook, the new test problem will be quickly added to the repository and released to the pip package with the next update.</p>
<p>** How to create a sensible inversion test problem</p>
<p>The code can include files of any format, but it has to include a file called <code class="docutils literal notranslate"><span class="pre">newproblem.py</span></code> that acts as the front end of the new test problem. This file should include the following functions:
- <code class="docutils literal notranslate"><span class="pre">basic()</span></code>
- <code class="docutils literal notranslate"><span class="pre">init_routine()</span></code>
- <code class="docutils literal notranslate"><span class="pre">forward()</span></code>
- <code class="docutils literal notranslate"><span class="pre">solver()</span></code>
- <code class="docutils literal notranslate"><span class="pre">plot_model()</span></code></p>
<p>These key functions can call any amount of sub-functions from within the file <code class="docutils literal notranslate"><span class="pre">newproblem.py</span></code>, or from within the same folder.</p>
<p>important points to note on how to convert a locally working problem into one that works within the ‘Inversion Test Problems’ package:</p>
<ul>
<li><p>We recommend to not use subfolders within ‘’newproblem’’. All data and scripts will be in the same folder after comiling.</p></li>
<li><p>If the code imports functions from the same folder that would usually be called by using <code class="docutils literal notranslate"><span class="pre">import</span> <span class="pre">auxillaryfunction</span></code>, it is necessary to change the line to <code class="docutils literal notranslate"><span class="pre">from</span> <span class="pre">inversiontestproblems.newproblem</span> <span class="pre">import</span> <span class="pre">auxillaryfunction</span></code>.</p></li>
<li><p>If data is included, then the correct path to where the pip package is installed has to be given. When giving the path, replace this:
<code class="docutils literal notranslate"><span class="pre">`console</span>
<span class="pre">np.load(''data.npz'')</span>
<span class="pre">`</span></code>
with the following, or your own version of it:</p>
<p><a href="#id1"><span class="problematic" id="id2">``</span></a><a href="#id3"><span class="problematic" id="id4">`</span></a>console
np.load(data_path(‘’data.npz’’))</p>
<dl class="simple">
<dt>def data_path(filename):</dt><dd><p>path_to_current_file = os.path.realpath(__file__)
current_directory = os.path.split(path_to_current_file)[0]
data_path = os.path.join(current_directory, filename)
return data_path</p>
</dd>
</dl>
<p><a href="#id5"><span class="problematic" id="id6">``</span></a><a href="#id7"><span class="problematic" id="id8">`</span></a></p>
</li>
</ul>
<p>Additionally, we encourage you to add a Jupyter Notebook with an identical name into the folder ‘’Jupyter Notebooks`` that contains the following:</p>
<ul class="simple">
<li><p>An extensive description of the new inversion test problem, containing information about (but not limited to)…
- the forward calculation (ie. the underlying physics) and how it was implemented.
- which inversion method is used (and regularisation) and how it was implemented.
- the physical unit of relevant variables, but at least of <code class="docutils literal notranslate"><span class="pre">model</span></code> and <code class="docutils literal notranslate"><span class="pre">data</span></code>.
- all changeable parameters, possibly in a list.</p></li>
<li><p>An example of the new problem being used, with a reasonable output.</p></li>
</ul>
</section>
</section>
</section>


                        
                    </div>
                </div>
            </div>
        </div>
    </div>    


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'0.0.1',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
    <script type="text/javascript" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script>
    <script type="text/javascript" src="None"></script>
    <script type="text/javascript" src="_static/js/theme.js"></script>
  
    <div class="footer" role="contentinfo">
        <div class="container">
            &#169; Copyright 2022, InLab.
        Created using <a href="http://sphinx-doc.org/">Sphinx</a> 4.2.0.
        </div>
    </div>  

</body>
</html>